import pytest

from leetcode_py import logged_test

from .helpers import assert_rotate, run_rotate
from .solution import Solution


class TestRotateImage:
    def setup_method(self):
        self.solution = Solution()

    @logged_test
    @pytest.mark.parametrize(
        "matrix, expected",
        [
            ([[1, 2, 3], [4, 5, 6], [7, 8, 9]], [[7, 4, 1], [8, 5, 2], [9, 6, 3]]),
            (
                [[5, 1, 9, 11], [2, 4, 8, 10], [13, 3, 6, 7], [15, 14, 12, 16]],
                [[15, 13, 2, 5], [14, 3, 4, 1], [12, 6, 8, 9], [16, 7, 10, 11]],
            ),
            ([[1]], [[1]]),
            ([[1, 2], [3, 4]], [[3, 1], [4, 2]]),
            (
                [
                    [1, 2, 3, 4, 5],
                    [6, 7, 8, 9, 10],
                    [11, 12, 13, 14, 15],
                    [16, 17, 18, 19, 20],
                    [21, 22, 23, 24, 25],
                ],
                [
                    [21, 16, 11, 6, 1],
                    [22, 17, 12, 7, 2],
                    [23, 18, 13, 8, 3],
                    [24, 19, 14, 9, 4],
                    [25, 20, 15, 10, 5],
                ],
            ),
            ([[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]),
            (
                [[-1, -2, -3], [-4, -5, -6], [-7, -8, -9]],
                [[-7, -4, -1], [-8, -5, -2], [-9, -6, -3]],
            ),
            (
                [[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12], [13, 14, 15, 16]],
                [[13, 9, 5, 1], [14, 10, 6, 2], [15, 11, 7, 3], [16, 12, 8, 4]],
            ),
            ([[100, 200], [300, 400]], [[300, 100], [400, 200]]),
            ([[1, 2, 3], [4, 5, 6], [7, 8, 9]], [[7, 4, 1], [8, 5, 2], [9, 6, 3]]),
            (
                [
                    [10, 20, 30, 40, 50, 60],
                    [70, 80, 90, 100, 110, 120],
                    [130, 140, 150, 160, 170, 180],
                    [190, 200, 210, 220, 230, 240],
                    [250, 260, 270, 280, 290, 300],
                    [310, 320, 330, 340, 350, 360],
                ],
                [
                    [310, 250, 190, 130, 70, 10],
                    [320, 260, 200, 140, 80, 20],
                    [330, 270, 210, 150, 90, 30],
                    [340, 280, 220, 160, 100, 40],
                    [350, 290, 230, 170, 110, 50],
                    [360, 300, 240, 180, 120, 60],
                ],
            ),
            ([[-1000, 1000], [-500, 500]], [[-500, -1000], [500, 1000]]),
        ],
    )
    def test_rotate(self, matrix: list[list[int]], expected: list[list[int]]):
        result = run_rotate(Solution, matrix)
        assert_rotate(result, expected)
